<%- include ('../partials/head') %>

    <main class="slds-card">
        
        <div class="slds-card">
                <div class="slds-text-heading_medium">Ready to go?</div>
                <div class="slds-text-body_regular">
                        아래의 3가지 퀘스트를 마치시면 됩니다.
                </div>
                <div class="slds-text-body_regular">
                    참고 user name : <%- username %>, password :  <%- password %>
                </div>
                <br/>               
                
        </div> 

        <div class="slds-card">
            <div class="slds-text-heading_medium">Question #1</div>
            <div class="slds-text-body_regular">
                    실제 데이터를 하나 입력합니다 #1
            </div>
            <center><button class="slds-button slds-button_brand" id="question1" onclick="question1_launch();">확인하기</button></center>
            <div id="status1" class="slds-m-bottom_small sfdx-output"></div>
        </div> 

        <div class="slds-card">
            <div class="slds-text-heading_medium">Question #2</div>
            <div class="slds-text-body_regular">
                    2개의 리포트를 만들어 봅시다 #2
            </div>
            <center><button class="slds-button slds-button_brand" id="question2" onclick="question1_launch();">확인하기</button></center>
            <div id="status2" class="slds-m-bottom_small sfdx-output"></div>
        </div> 

        <div class="slds-card">
            <div class="slds-text-heading_medium">Question #3</div>
            <div class="slds-text-body_regular">
                    앞의 리포트를 활용하여 대시보드를 만들어 봅시다 #3
            </div>
            <center><button class="slds-button slds-button_brand" id="question3" onclick="question1_launch();">확인하기</button></center>
            <div id="status3" class="slds-m-bottom_small sfdx-output"></div>
        </div> 

        <div id="errorBlock" style="display: none;">
            <div class="slds-notify_container slds-is-relative slds-m-bottom_large sfdx-wrap">

                <div class="slds-notify slds-notify_toast slds-theme_error" role="alert">
                    <span class="slds-assistive-text">Error</span>

                    <div class="slds-notify__content">
                        <h2 class="slds-text-heading_small ">
                            <strong id="errorTest">An error occurred while deploying.</strong>&nbsp;See the browser console logs for more
                            information.
                        </h2>
                    </div>
                </div>

            </div>
        </div>

        <script>

        var varusername = '<%- JSON.stringify(username) %>'.replaceAll('"', '');
        //varusername.replace('\"','');
        console.log('++ Sunny : varusername : [', varusername + ']');

        var varpassword = '<%- JSON.stringify(password) %>'.replaceAll('"', '');
        //varpassword.replace('\"','');
        console.log('++ Sunny : varpassword : [', varpassword + ']');

        question1_launch=function() {
            //defaultContent('Questions !!');
            const statusnumber = "status1";
            var _urlstr = "/trailhead?action=checkTravelApprovalRecord&username=" + varusername + "&password=" + varpassword;
            fetch(_urlstr)
                .then((response) => {
                    console.log("response:", response);
                    console.log("response:", response.text);
                    console.log("response:", response.statusText);
                    console.log("response:", response.body);
                    console.log("response:", response.json);
                    console.log("response:", response.statusText);

                    //defaultContent(response.ok, statusnumber);
                    if(response.ok == true) {
                        document.getElementById("question1").disabled = true;
                        document.getElementById("question1").innerHTML = "Done";
                        defaultContent(response.ok, statusnumber);
                    } else {
                        defaultContent(response.errormsg, statusnumber);
                    }
                    }
                )
                .then((data) => console.log(data))
                .catch((error) => {
                    console.log("error:", error);
                    defaultContent(error, statusnumber);}
                )

        }

        defaultContent = function (content, varwhere) {
            var para = document.createElement("p");
            para.classList.add('slds-m-vertical_medium');
            var node = document.createTextNode(content);
            para.appendChild(node);

            var element = document.getElementById(varwhere);
            element.appendChild(para);
        }

        </script>
        

    </main>
    <%- include ('../partials/footer') %>